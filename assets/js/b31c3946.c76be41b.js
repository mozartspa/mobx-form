(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[502],{3905:function(e,n,a){"use strict";a.d(n,{Zo:function(){return p},kt:function(){return c}});var t=a(7294);function i(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function l(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),a.push.apply(a,t)}return a}function r(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?l(Object(a),!0).forEach((function(n){i(e,n,a[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(a,n))}))}return e}function o(e,n){if(null==e)return{};var a,t,i=function(e,n){if(null==e)return{};var a,t,i={},l=Object.keys(e);for(t=0;t<l.length;t++)a=l[t],n.indexOf(a)>=0||(i[a]=e[a]);return i}(e,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(t=0;t<l.length;t++)a=l[t],n.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}var d=t.createContext({}),s=function(e){var n=t.useContext(d),a=n;return e&&(a="function"==typeof e?e(n):r(r({},n),e)),a},p=function(e){var n=s(e.components);return t.createElement(d.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},m=t.forwardRef((function(e,n){var a=e.components,i=e.mdxType,l=e.originalType,d=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),m=s(a),c=i,v=m["".concat(d,".").concat(c)]||m[c]||u[c]||l;return a?t.createElement(v,r(r({ref:n},p),{},{components:a})):t.createElement(v,r({ref:n},p))}));function c(e,n){var a=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var l=a.length,r=new Array(l);r[0]=m;var o={};for(var d in n)hasOwnProperty.call(n,d)&&(o[d]=n[d]);o.originalType=e,o.mdxType="string"==typeof e?e:i,r[1]=o;for(var s=2;s<l;s++)r[s]=a[s];return t.createElement.apply(null,r)}return t.createElement.apply(null,a)}m.displayName="MDXCreateElement"},1774:function(e,n,a){"use strict";a.r(n),a.d(n,{frontMatter:function(){return o},metadata:function(){return d},toc:function(){return s},default:function(){return u}});var t=a(2122),i=a(9756),l=(a(7294),a(3905)),r=["components"],o={sidebar_position:3},d={unversionedId:"getting-started/validation",id:"getting-started/validation",isDocsHomePage:!1,title:"Validation",description:"Complex validation behaviors can be achieved combining the Form-level validation and the Field-level validation, controlling when each of those should occur.",source:"@site/docs/getting-started/validation.md",sourceDirName:"getting-started",slug:"/getting-started/validation",permalink:"/mobx-form/docs/getting-started/validation",editUrl:"https://github.com/mozartspa/mobx-form/edit/master/website/docs/getting-started/validation.md",version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"Nested and array fields",permalink:"/mobx-form/docs/getting-started/nested-array-fields"},next:{title:"Submit",permalink:"/mobx-form/docs/getting-started/submit"}},s=[{value:"Form-level validation",id:"form-level-validation",children:[{value:"Async validation",id:"async-validation",children:[]},{value:"Debouncing",id:"debouncing",children:[]},{value:"When does form validation run?",id:"when-does-form-validation-run",children:[]}]},{value:"Field-level validation",id:"field-level-validation",children:[{value:"Async validation",id:"async-validation-1",children:[]},{value:"Debouncing",id:"debouncing-1",children:[]},{value:"When does field validation run?",id:"when-does-field-validation-run",children:[]},{value:"<code>validateOnChangeFields</code>",id:"validateonchangefields",children:[]}]}],p={toc:s};function u(e){var n=e.components,a=(0,i.Z)(e,r);return(0,l.kt)("wrapper",(0,t.Z)({},p,a,{components:n,mdxType:"MDXLayout"}),(0,l.kt)("p",null,"Complex validation behaviors can be achieved combining the Form-level validation and the Field-level validation, controlling when each of those should occur."),(0,l.kt)("h2",{id:"form-level-validation"},"Form-level validation"),(0,l.kt)("p",null,"Pass a ",(0,l.kt)("inlineCode",{parentName:"p"},"onValidate")," function to ",(0,l.kt)("inlineCode",{parentName:"p"},"useForm()"),":"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-typescript"},'const form = useForm({\n  initialValues: { name: "", email: "" },\n  onValidate: (values) => {\n    let errors: FormErrors = {}\n    if (values.name.length === 0) {\n      errors.name = "Name is required."\n    }\n    if (values.email.length === 0) {\n      errors.email = "Email is required."\n    }\n    return errors\n  },\n})\n')),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"onValidate")," receives the values of the form and should return an object whose keys are the field names (with ",(0,l.kt)("strong",{parentName:"p"},"dot notation"),") and the value is ",(0,l.kt)("inlineCode",{parentName:"p"},"string | string[] | undefined"),":"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"string")," in case of a single error message"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"string[]")," in case of multiple error messages"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"undefined")," means no error")),(0,l.kt)("p",null,"For example:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-typescript"},'onValidate: (values) => {\n  return {\n    name: undefined,\n    email: [\n      "Email is not a valid email",\n      "Email should be a maximum of 20 characters long",\n    ],\n  }\n}\n')),(0,l.kt)("p",null,"In this case, ",(0,l.kt)("inlineCode",{parentName:"p"},"name")," has no errors and ",(0,l.kt)("inlineCode",{parentName:"p"},"email")," has 2 errors."),(0,l.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"You can use any ",(0,l.kt)("strong",{parentName:"p"},"validation library")," you prefer (as ",(0,l.kt)("strong",{parentName:"p"},(0,l.kt)("a",{parentName:"strong",href:"https://www.npmjs.com/package/yup"},"yup")),", ",(0,l.kt)("strong",{parentName:"p"},(0,l.kt)("a",{parentName:"strong",href:"https://www.npmjs.com/package/zod"},"zod")),", or ",(0,l.kt)("strong",{parentName:"p"},(0,l.kt)("a",{parentName:"strong",href:"https://www.npmjs.com/package/joi"},"joi")),"). Then you should convert the errors provided by your validation library into an object whose keys are the field names (with ",(0,l.kt)("strong",{parentName:"p"},"dot notation"),") and the value is ",(0,l.kt)("inlineCode",{parentName:"p"},"string | string[] | undefined"),"."))),(0,l.kt)("h3",{id:"async-validation"},"Async validation"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"onValidate")," can be an async function:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-typescript"},"onValidate: async (values) => {\n  // Call an API, for example\n  const errors = await MyApi.fetchErrors(values)\n  return errors\n}\n")),(0,l.kt)("h3",{id:"debouncing"},"Debouncing"),(0,l.kt)("p",null,"In case of async validation (that calls an API, for example), it would be convenient to debounce the validation in order to avoid calling the API too frequently. Pass a ",(0,l.kt)("inlineCode",{parentName:"p"},"validateDebounce")," prop to ",(0,l.kt)("inlineCode",{parentName:"p"},"useForm()"),":"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-typescript",metastring:"{3}","{3}":!0},"const form = useForm({\n  // ...\n  validateDebounce: true,\n  onValidate: async (values) => {\n    // Call an API, for example\n    const errors = await MyAPI.fetchErrors(values)\n    return errors\n  },\n})\n")),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"validateDebounce")," is of type: ",(0,l.kt)("inlineCode",{parentName:"p"},"boolean | number | { wait?: number; leading?: boolean }")),(0,l.kt)("p",null,"If you pass:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"false"),": debounce will not be active (as per default)"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"true"),": debounce will be active, with default values for ",(0,l.kt)("inlineCode",{parentName:"li"},"wait")," (300) and ",(0,l.kt)("inlineCode",{parentName:"li"},"leading")," (false)"),(0,l.kt)("li",{parentName:"ul"},"a ",(0,l.kt)("inlineCode",{parentName:"li"},"number"),": debounce will be active with ",(0,l.kt)("inlineCode",{parentName:"li"},"wait")," as the number you passed, and ",(0,l.kt)("inlineCode",{parentName:"li"},"leading")," false"),(0,l.kt)("li",{parentName:"ul"},"a ",(0,l.kt)("inlineCode",{parentName:"li"},"{ wait?: number; leading?: boolean }")," object: debounce will be active with the values you passed")),(0,l.kt)("h3",{id:"when-does-form-validation-run"},"When does form validation run?"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"When you submit the form."),(0,l.kt)("li",{parentName:"ul"},"When a field value changes - if ",(0,l.kt)("inlineCode",{parentName:"li"},"validateOnChange")," is ",(0,l.kt)("inlineCode",{parentName:"li"},"true")," (",(0,l.kt)("strong",{parentName:"li"},"true")," by default)."),(0,l.kt)("li",{parentName:"ul"},"When a ",(0,l.kt)("inlineCode",{parentName:"li"},"blur")," event occurs - if ",(0,l.kt)("inlineCode",{parentName:"li"},"validateOnBlur")," is ",(0,l.kt)("inlineCode",{parentName:"li"},"true")," (",(0,l.kt)("strong",{parentName:"li"},"false")," by default)."),(0,l.kt)("li",{parentName:"ul"},"When you imperatively ask for it - with ",(0,l.kt)("inlineCode",{parentName:"li"},"form.validate()"),".")),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"validateOnChange")," and ",(0,l.kt)("inlineCode",{parentName:"p"},"validateOnBlur")," are two booleans you can pass to ",(0,l.kt)("inlineCode",{parentName:"p"},"useForm()"),":"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-typescript",metastring:"{3,4}","{3,4}":!0},"const form = useForm({\n  // ...\n  validateOnChange: false,\n  validateOnBlur: true,\n  // ...\n})\n")),(0,l.kt)("p",null,"In this case, validation will run when a ",(0,l.kt)("inlineCode",{parentName:"p"},"blur")," event occurs and when the form is submitted."),(0,l.kt)("h2",{id:"field-level-validation"},"Field-level validation"),(0,l.kt)("p",null,"Pass a ",(0,l.kt)("inlineCode",{parentName:"p"},"validate")," function to ",(0,l.kt)("inlineCode",{parentName:"p"},"useField()")," or ",(0,l.kt)("inlineCode",{parentName:"p"},"<Field/>"),":"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-typescript",metastring:"{3-11,18-20}","{3-11,18-20}":!0},'useField("email", {\n  // ...\n  validate: (value, values) => {\n    if (value.length === 0) {\n      return "Email is required"\n    } else if (value.length > 20) {\n      return "Email should be a maximum of 20 characters long"\n    } else {\n      return undefined\n    }\n  },\n})\n\n// or\n\n<Field\n  name="email"\n  validate={(value, values) => {\n    // your validation function\n  }}\n>\n  {(field) => (/* ... */)}\n</Field>\n')),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"validate")," receives the value of the field and the values of the form, and it should return a value of type ",(0,l.kt)("inlineCode",{parentName:"p"},"string | string[] | undefined"),"."),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"string")," in case of a single error message"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"string[]")," in case of multiple error messages"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"undefined")," means no error")),(0,l.kt)("h3",{id:"async-validation-1"},"Async validation"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"validate")," can be an async function:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-typescript"},'useField("email", {\n  // ...\n  validate: async (value, values) => {\n    // Call an API, for example\n    const error = await MyAPI.fetchIsEmailValid(value)\n    return error\n  },\n})\n')),(0,l.kt)("h3",{id:"debouncing-1"},"Debouncing"),(0,l.kt)("p",null,"Similarly to ",(0,l.kt)("a",{parentName:"p",href:"#debouncing"},"form validation")," you can pass a ",(0,l.kt)("inlineCode",{parentName:"p"},"validateDebounce")," value."),(0,l.kt)("h3",{id:"when-does-field-validation-run"},"When does field validation run?"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"When the form validation runs, also field-level validations run - errors will be merged"),(0,l.kt)("li",{parentName:"ul"},"When the field value changes - if ",(0,l.kt)("inlineCode",{parentName:"li"},"validateOnChange")," is ",(0,l.kt)("inlineCode",{parentName:"li"},"true")," (",(0,l.kt)("strong",{parentName:"li"},"false")," by default)."),(0,l.kt)("li",{parentName:"ul"},"When other field values change - if ",(0,l.kt)("inlineCode",{parentName:"li"},"validateOnChangeFields")," is passed."),(0,l.kt)("li",{parentName:"ul"},"When the field ",(0,l.kt)("inlineCode",{parentName:"li"},"blur")," event occurs - if ",(0,l.kt)("inlineCode",{parentName:"li"},"validateOnBlur")," is ",(0,l.kt)("inlineCode",{parentName:"li"},"true")," (",(0,l.kt)("strong",{parentName:"li"},"false")," by default)."),(0,l.kt)("li",{parentName:"ul"},"When you imperatively ask for it - with ",(0,l.kt)("inlineCode",{parentName:"li"},"field.validate()"),".")),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"validateOnChange")," and ",(0,l.kt)("inlineCode",{parentName:"p"},"validateOnBlur")," are two booleans you can pass to ",(0,l.kt)("inlineCode",{parentName:"p"},"useField()")," (or to ",(0,l.kt)("inlineCode",{parentName:"p"},"<Field />"),"):"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-typescript",metastring:"{3,4}","{3,4}":!0},'const field = useField("email", {\n  // ...\n  validateOnChange: true,\n  validateOnBlur: false,\n  // ...\n})\n')),(0,l.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"Field level's ",(0,l.kt)("inlineCode",{parentName:"p"},"validateOnChange")," and ",(0,l.kt)("inlineCode",{parentName:"p"},"validateOnBlur")," are independent from Form level's ",(0,l.kt)("inlineCode",{parentName:"p"},"validateOnChange")," and ",(0,l.kt)("inlineCode",{parentName:"p"},"validateOnBlur"),". You can mix them to achieve different behaviors of validation."),(0,l.kt)("p",{parentName:"div"},"For example you can turn off ",(0,l.kt)("inlineCode",{parentName:"p"},"validateOnChange")," and ",(0,l.kt)("inlineCode",{parentName:"p"},"validateOnBlur")," on the form, and turn on only ",(0,l.kt)("inlineCode",{parentName:"p"},"validateOnChange")," on a specific field. The result will be that the whole form validation will run only on submit, and the validation of that specific field will run while changing the value of the field."))),(0,l.kt)("h3",{id:"validateonchangefields"},(0,l.kt)("inlineCode",{parentName:"h3"},"validateOnChangeFields")),(0,l.kt)("p",null,"In case your form validation is turned off (form ",(0,l.kt)("inlineCode",{parentName:"p"},"validateOnChange")," is ",(0,l.kt)("inlineCode",{parentName:"p"},"false"),") ",(0,l.kt)("strong",{parentName:"p"},"but")," you want your field be validated every time other fields change, then you should use the ",(0,l.kt)("inlineCode",{parentName:"p"},"validateOnChangeFields")," options:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-typescript"},'useField("confirmEmail", {\n  validateOnChangeFields: ["email"],\n  validate: (value, values) => {\n    if (value !== values.email) {\n      return "Confirm email should be equal to email"\n    } else {\n      return undefined\n    }\n  },\n})\n')),(0,l.kt)("p",null,"In this way, while the user is typing into the ",(0,l.kt)("inlineCode",{parentName:"p"},"email")," field, the error appears in the ",(0,l.kt)("inlineCode",{parentName:"p"},"confirmEmail")," field, complaining that the two emails are not equal."),(0,l.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"If you pass a ",(0,l.kt)("inlineCode",{parentName:"p"},"validateOnChangeFields")," value that is ",(0,l.kt)("strong",{parentName:"p"},"not")," ",(0,l.kt)("inlineCode",{parentName:"p"},"undefined"),", field's ",(0,l.kt)("inlineCode",{parentName:"p"},"validateOnChange")," is automatically considered ",(0,l.kt)("inlineCode",{parentName:"p"},"true")," unless you set it to ",(0,l.kt)("inlineCode",{parentName:"p"},"false"),"."))))}u.isMDXComponent=!0}}]);